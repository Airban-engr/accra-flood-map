<!DOCTYPE html>
<html>
<head>
  <!-- Open Graph tags for social previews -->
<meta property="og:title" content="Accra Flood Risk Map – Demo">
<meta property="og:description" content="An interactive map showing flood-prone zones across Accra, with risk levels (High, Medium, Low).">
<meta property="og:type" content="website">
<meta property="og:url" content="https://airban-engr.github.io/accra-flood-map/">
<meta property="og:image" content="https://airban-engr.github.io/accra-flood-map/preview.png">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<!-- Twitter Card tags -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Accra Flood Risk Map – Demo">
<meta name="twitter:description" content="Interactive flood risk zones for Accra with risk-level styling and map popups.">
<meta name="twitter:image" content="https://airban-engr.github.io/accra-flood-map/preview.png">

</head>
<body>
  <div id="map"></div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // Initialize the map centered on Accra
    const map = L.map('map').setView([5.56, -0.20], 12);

    // Add OpenStreetMap basemap
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      maxZoom: 19,
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // Function to color polygons by risk level
    const riskColor = r =>
      r === 'High' ? '#d62828' :    // red
      r === 'Medium' ? '#f77f00' :  // orange
      r === 'Low' ? '#fcbf49' :     // yellow
      '#6c757d';                    // gray fallback

    // Load flood risk polygons
    fetch('data/flood_risk_zones.geojson')
      .then(r => r.json())
      .then(geo => {
        // Add polygons
        const flood = L.geoJSON(geo, {
          style: f => ({
            color: riskColor(f.properties.risk),
            weight: 1,
            fillColor: riskColor(f.properties.risk),
            fillOpacity: 0.25
          }),
          onEachFeature: (f, l) => {
            const { name = 'Area', risk = 'Unknown' } = f.properties || {};
            l.bindPopup(`<b>${name}</b><br>Flood Risk: <b>${risk}</b>`);
          }
        }).addTo(map);

        // Zoom to fit polygons
        try { map.fitBounds(flood.getBounds(), { padding: [20,20] }); } catch(e) {}

        // Add legend
        const legend = L.control({position:'bottomright'});
        legend.onAdd = () => {
          const div = L.DomUtil.create('div');
          div.style.cssText = 'background:rgba(255,255,255,.95);padding:8px 10px;border-radius:6px;box-shadow:0 2px 8px rgba(0,0,0,.15);font:12px system-ui;';
          div.innerHTML = `
            <b>Flood Risk</b>
            <div style="margin-top:6px">
              <div style="display:flex;align-items:center;gap:6px;margin:2px 0">
                <span style="width:12px;height:12px;background:#d62828;border:1px solid #999;display:inline-block"></span> High
              </div>
              <div style="display:flex;align-items:center;gap:6px;margin:2px 0">
                <span style="width:12px;height:12px;background:#f77f00;border:1px solid #999;display:inline-block"></span> Medium
              </div>
              <div style="display:flex;align-items:center;gap:6px;margin:2px 0">
                <span style="width:12px;height:12px;background:#fcbf49;border:1px solid #999;display:inline-block"></span> Low
              </div>
            </div>`;
          return div;
        };
        legend.addTo(map);
      })
      .catch(err => {
        console.error('Could not load flood_risk_zones.geojson', err);
        alert('Flood data missing or invalid. Make sure it exists in /data/flood_risk_zones.geojson');
      });
  </script>
</body>
</html>

